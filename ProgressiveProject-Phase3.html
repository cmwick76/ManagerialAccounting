<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Phase 3: Process Costing & Advanced Pivot Tables | Apex Manufacturing</title>
    <link href="https://fonts.googleapis.com/css2?family=Raleway:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Raleway', Arial, sans-serif;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            color: #333;
            line-height: 1.6;
        }

        /* Brand Colors - Apex Manufacturing */
        :root {
            --primary-blue: #0033A0;
            --sunglow: #FFCB1F;
            --battleship-gray: #898989;
            --white: #FFFFFF;
            --black: #000000;
            --success-green: #5CB85C;
            --error-red: #D9534F;
        }

        .header {
            background: var(--primary-blue);
            color: var(--white);
            padding: 2rem 0;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .header-content {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 2rem;
        }

        .header h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            letter-spacing: -0.5px;
        }

        .header p {
            font-size: 1.1rem;
            font-weight: 400;
            opacity: 0.95;
        }

        .accent-bar {
            height: 8px;
            background: linear-gradient(90deg, var(--sunglow) 0%, var(--primary-blue) 100%);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 2rem;
        }

        .intro-section {
            background: var(--white);
            padding: 2rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
            border-left: 6px solid var(--sunglow);
        }

        .intro-section h2 {
            color: var(--primary-blue);
            font-size: 1.8rem;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .tutorial-section {
            background: var(--white);
            padding: 2.5rem;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            margin-bottom: 2rem;
            border-top: 5px solid var(--primary-blue);
        }

        .tutorial-section h2 {
            color: var(--primary-blue);
            font-size: 1.8rem;
            margin-bottom: 1.5rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            cursor: pointer;
            user-select: none;
            position: relative;
            padding-right: 3rem;
            transition: color 0.3s ease;
        }

        .tutorial-section h2::after {
            content: '‚ñº';
            position: absolute;
            right: 0.5rem;
            transition: transform 0.3s ease;
            font-size: 1.2rem;
        }

        .tutorial-section.collapsed h2::after {
            transform: rotate(90deg);
        }

        .tutorial-section h2:hover {
            color: #0047cc;
        }

        .tutorial-section .tutorial-content {
            max-height: 10000px;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }

        .tutorial-section.collapsed .tutorial-content {
            max-height: 0;
        }

        .tutorial-section h3 {
            color: var(--primary-blue);
            font-size: 1.3rem;
            margin: 1.5rem 0 1rem 0;
            font-weight: 600;
            border-left: 4px solid var(--sunglow);
            padding-left: 1rem;
        }

        .tutorial-section h4 {
            color: #555;
            font-size: 1.1rem;
            margin: 1rem 0 0.5rem 0;
            font-weight: 600;
        }

        .step-list {
            background: #f8f9fa;
            padding: 1.5rem;
            border-radius: 8px;
            margin: 1rem 0;
            border-left: 4px solid var(--sunglow);
        }

        .step-list ol {
            margin-left: 1.5rem;
        }

        .step-list li {
            margin-bottom: 0.8rem;
            line-height: 1.6;
        }

        .step-list li strong {
            color: var(--primary-blue);
        }

        .code-example {
            background: #263238;
            color: #aed581;
            padding: 1rem 1.5rem;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            font-size: 0.95rem;
            margin: 1rem 0;
            overflow-x: auto;
            border-left: 4px solid var(--sunglow);
        }

        .code-example .comment {
            color: #80CBC4;
        }

        .code-example .function {
            color: #FFD54F;
        }

        .tip-box {
            background: #e8f5e9;
            border-left: 5px solid var(--success-green);
            padding: 1rem 1.5rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .tip-box strong {
            color: var(--success-green);
            font-weight: 700;
        }

        .warning-box {
            background: #fff3e0;
            border-left: 5px solid #ff9800;
            padding: 1rem 1.5rem;
            margin: 1rem 0;
            border-radius: 4px;
        }

        .warning-box strong {
            color: #ff9800;
            font-weight: 700;
        }

        .example-table {
            width: 100%;
            margin: 1rem 0;
            border-collapse: collapse;
            font-size: 0.9rem;
        }

        .example-table th {
            background: var(--battleship-gray);
            color: var(--white);
            padding: 0.8rem;
            text-align: left;
            font-weight: 600;
        }

        .example-table td {
            padding: 0.6rem 0.8rem;
            border: 1px solid #dee2e6;
        }

        .example-table tr:nth-child(even) {
            background: #f8f9fa;
        }

        .tutorial-nav {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1rem;
            max-width: 900px;
            margin: 2rem auto;
            padding: 1.5rem;
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 8px;
        }

        .tutorial-nav a {
            padding: 1rem;
            background: var(--white);
            color: var(--primary-blue);
            text-decoration: none;
            border-radius: 6px;
            border: 2px solid var(--primary-blue);
            font-weight: 600;
            text-align: center;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            min-height: 60px;
        }

        .tutorial-nav a:hover {
            background: var(--primary-blue);
            color: var(--white);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,51,160,0.2);
        }

        .visual-example {
            background: var(--white);
            border: 2px solid #dee2e6;
            padding: 1.5rem;
            margin: 1rem 0;
            border-radius: 8px;
        }

        .excel-cell {
            display: inline-block;
            padding: 0.5rem 1rem;
            background: var(--white);
            border: 2px solid var(--primary-blue);
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            margin: 0.25rem;
            font-weight: 600;
        }

        .excel-cell.formula {
            background: #fff9e6;
            border-color: var(--sunglow);
        }

        .excel-cell.result {
            background: #e8f5e9;
            border-color: var(--success-green);
        }

        .instructions {
            background: #fff9e6;
            border-left: 5px solid var(--sunglow);
            padding: 1.5rem;
            margin-bottom: 2rem;
            border-radius: 4px;
        }

        .instructions h4 {
            color: var(--primary-blue);
            margin-bottom: 0.8rem;
            font-weight: 600;
        }

        .instructions ul {
            margin-left: 1.5rem;
        }

        .instructions li {
            margin-bottom: 0.5rem;
        }

        .check-figures-section {
            background: linear-gradient(135deg, var(--primary-blue) 0%, #0047cc 100%);
            padding: 2.5rem;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,51,160,0.3);
            margin-top: 2rem;
            color: var(--white);
        }

        .check-figures-section h3 {
            color: var(--sunglow);
            font-size: 1.8rem;
            margin-bottom: 1rem;
            font-weight: 700;
            text-align: center;
        }

        .check-figures-section p {
            text-align: center;
            margin-bottom: 2rem;
            font-size: 1.05rem;
        }

        .check-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }

        .check-item {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            padding: 1.5rem;
            border-radius: 8px;
            border: 2px solid rgba(255, 203, 31, 0.3);
            transition: all 0.3s ease;
        }

        .check-item:hover {
            border-color: var(--sunglow);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(255, 203, 31, 0.2);
        }

        .check-item label {
            display: block;
            font-weight: 600;
            margin-bottom: 0.8rem;
            color: var(--sunglow);
            font-size: 0.95rem;
            line-height: 1.3;
        }

        .check-item input {
            width: 100%;
            padding: 0.8rem;
            border: 2px solid rgba(255, 255, 255, 0.3);
            border-radius: 6px;
            font-size: 1rem;
            font-family: 'Courier New', monospace;
            background: rgba(255, 255, 255, 0.95);
            color: var(--black);
            transition: all 0.3s ease;
        }

        .check-item input:focus {
            outline: none;
            border-color: var(--sunglow);
            background: var(--white);
        }

        .check-item .feedback {
            margin-top: 0.8rem;
            padding: 0.6rem;
            border-radius: 4px;
            font-weight: 600;
            text-align: center;
            display: none;
        }

        .check-item .feedback.correct {
            background: var(--success-green);
            color: var(--white);
            display: block;
        }

        .check-item .feedback.incorrect {
            background: var(--error-red);
            color: var(--white);
            display: block;
        }

        .verify-all-btn {
            display: block;
            width: 100%;
            max-width: 400px;
            margin: 2rem auto 0;
            padding: 1.2rem 2rem;
            background: var(--sunglow);
            color: var(--primary-blue);
            border: none;
            border-radius: 8px;
            font-size: 1.2rem;
            font-weight: 700;
            font-family: 'Raleway', sans-serif;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(255, 203, 31, 0.3);
        }

        .verify-all-btn:hover {
            background: #ffd84d;
            transform: translateY(-2px);
            box-shadow: 0 6px 16px rgba(255, 203, 31, 0.4);
        }

        .verify-all-btn:active {
            transform: translateY(0);
        }

        .overall-score {
            text-align: center;
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(255, 255, 255, 0.15);
            border-radius: 8px;
            font-size: 1.3rem;
            font-weight: 700;
            display: none;
        }

        .overall-score.show {
            display: block;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8rem;
            }
            
            .check-grid {
                grid-template-columns: 1fr;
            }
            
            .container {
                padding: 1rem;
            }

            .tutorial-nav {
                grid-template-columns: 1fr;
            }
        }

        .tooltip {
            position: relative;
            display: inline-block;
            cursor: help;
            color: var(--sunglow);
            margin-left: 5px;
        }

        .tooltip .tooltiptext {
            visibility: hidden;
            width: 200px;
            background-color: #555;
            color: #fff;
            text-align: center;
            border-radius: 6px;
            padding: 8px;
            position: absolute;
            z-index: 1;
            bottom: 125%;
            left: 50%;
            margin-left: -100px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 0.85rem;
        }

        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
    </style>
</head>
<body>
    <div class="header">
        <div class="header-content">
            <h1>Phase 3: Process Costing & Advanced Pivot Analysis</h1>
            <p>Apex Manufacturing Solutions | Chapter 16</p>
        </div>
    </div>
    <div class="accent-bar"></div>

    <div class="container">
        <div class="intro-section">
            <h2>Welcome to Phase 3!</h2>
            <p>Apex Manufacturing is expanding into mass production! This phase introduces process costing for continuous manufacturing operations. You'll calculate equivalent units, track costs through multiple departments, and use advanced pivot table features including calculated fields, slicers, and timelines to analyze production efficiency across departments and time periods.</p>
        </div>

        <div class="instructions">
            <h4>üìã Phase 3 Requirements:</h4>
            <ul>
                <li><strong>Process Costing:</strong> Calculate equivalent units (weighted average method), costs per equivalent unit, and complete production cost reports for multiple departments</li>
                <li><strong>Advanced Pivot Tables (4 Tasks - 15% of Phase 3 grade):</strong>
                    <ul style="margin-top: 0.5rem; margin-left: 1.5rem;">
                        <li>Task 1: Create calculated field for cost per unit in pivot table</li>
                        <li>Task 2: Add slicers for interactive department filtering</li>
                        <li>Task 3: Add timeline for monthly analysis</li>
                        <li>Task 4: Create executive dashboard with multiple pivot charts</li>
                    </ul>
                </li>
                <li><strong>Management Report:</strong> Analyze production efficiency, identify bottleneck departments, and recommend process improvements</li>
                <li>Advanced pivot table skills build on Phase 2 foundation</li>
            </ul>
        </div>

        <div class="tutorial-nav">
            <a href="javascript:void(0)" onclick="expandTutorial('tutorial1')">üßÆ Calculated Fields</a>
            <a href="javascript:void(0)" onclick="expandTutorial('tutorial2')">üéõÔ∏è Slicers</a>
            <a href="javascript:void(0)" onclick="expandTutorial('tutorial3')">üìÖ Timelines</a>
            <a href="javascript:void(0)" onclick="expandTutorial('tutorial4')">üìä Executive Dashboards</a>
            <a href="javascript:void(0)" onclick="expandTutorial('tutorial5')">üîÑ Grouping Data</a>
            <a href="javascript:void(0)" onclick="expandTutorial('tutorial6')">‚ö° Power Pivot Preview</a>
        </div>

        <!-- TUTORIAL 1: CALCULATED FIELDS -->
        <div id="tutorial1" class="tutorial-section">
            <h2 onclick="toggleTutorial('tutorial1')">üßÆ Tutorial 1: Calculated Fields in Pivot Tables</h2>
            <div class="tutorial-content">
            <p>Calculated fields let you create new calculations within your pivot table without changing your source data. Perfect for ratios, percentages, and custom metrics!</p>

            <h3>What is a Calculated Field?</h3>
            <p>A calculated field is a new column you create in your pivot table using a formula based on existing fields. For example:</p>
            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                <li>Cost per Unit = Total Cost / Units Produced</li>
                <li>Profit Margin = (Revenue - Cost) / Revenue</li>
                <li>Labor Cost % = Direct Labor / Total Cost</li>
                <li>Efficiency Ratio = Standard Hours / Actual Hours</li>
            </ul>

            <h3>Step-by-Step: Creating a Calculated Field</h3>
            <div class="step-list">
                <ol>
                    <li><strong>Click anywhere</strong> in your pivot table</li>
                    <li><strong>Go to PivotTable Analyze tab</strong> in the ribbon</li>
                    <li><strong>Click "Fields, Items, & Sets"</strong> dropdown</li>
                    <li><strong>Choose "Calculated Field"</strong></li>
                    <li><strong>Name your field</strong> (e.g., "Cost per Unit")</li>
                    <li><strong>Enter your formula</strong> by clicking field names and adding operators:
                        <ul style="margin-top: 0.5rem;">
                            <li>Example: = 'Total Cost' / 'Units Produced'</li>
                            <li>Use single quotes around field names with spaces</li>
                            <li>Use operators: + - * / ( )</li>
                        </ul>
                    </li>
                    <li><strong>Click Add</strong>, then <strong>OK</strong></li>
                    <li>New field appears in VALUES area automatically!</li>
                </ol>
            </div>

            <div class="visual-example">
                <p><strong>Example: Adding Cost per Unit</strong></p>
                <p>Name: <span class="excel-cell">Cost per Unit</span></p>
                <p>Formula: <span class="excel-cell formula">= 'Total Cost' / 'Units Produced'</span></p>
                <p>Result: New column shows $52.50, $48.75, $51.20 per unit for each department</p>
            </div>

            <h3>Task 1: Creating Cost per Unit Field</h3>
            <div class="step-list">
                <ol>
                    <li><strong>Start with your Department pivot table</strong> from Phase 2</li>
                    <li><strong>PivotTable Analyze</strong> ‚Üí Fields, Items, & Sets ‚Üí Calculated Field</li>
                    <li><strong>Name:</strong> "Cost per Unit"</li>
                    <li><strong>Formula:</strong> = 'Total Cost' / 'Units Completed'</li>
                    <li><strong>Click Add</strong>, then OK</li>
                    <li><strong>Format the new column</strong> as Currency with 2 decimals</li>
                    <li><strong>Right-click column header</strong> ‚Üí Value Field Settings ‚Üí Number Format</li>
                </ol>
            </div>

            <h3>Common Calculated Field Formulas</h3>
            <table class="example-table">
                <thead>
                    <tr>
                        <th>What You Want</th>
                        <th>Formula</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Cost per Unit</td>
                        <td>= 'Total Cost' / 'Units'</td>
                        <td>Format as Currency</td>
                    </tr>
                    <tr>
                        <td>Profit Margin %</td>
                        <td>= ('Revenue' - 'Cost') / 'Revenue'</td>
                        <td>Format as Percentage</td>
                    </tr>
                    <tr>
                        <td>Labor as % of Total</td>
                        <td>= 'Direct Labor' / 'Total Cost'</td>
                        <td>Format as Percentage</td>
                    </tr>
                    <tr>
                        <td>Overhead Rate</td>
                        <td>= 'Overhead' / 'Direct Labor'</td>
                        <td>Shows OH as % of DL</td>
                    </tr>
                    <tr>
                        <td>Average per Employee</td>
                        <td>= 'Total Sales' / 'Employee Count'</td>
                        <td>Performance metric</td>
                    </tr>
                </tbody>
            </table>

            <div class="tip-box">
                <strong>üí° PRO TIP:</strong> Calculated fields aggregate at each level. If you have Department rows, the formula calculates separately for each department. Grand Total also uses the formula (not just sum of rows)!
            </div>

            <div class="warning-box">
                <strong>‚ö†Ô∏è LIMITATION:</strong> Calculated fields can only use SUM aggregation. You can't use COUNT, AVERAGE, or other functions. For complex calculations, create the column in your source data first, then use it in the pivot table.
            </div>

            <h3>Editing or Deleting Calculated Fields</h3>
            <div class="step-list">
                <ol>
                    <li><strong>PivotTable Analyze</strong> ‚Üí Fields, Items, & Sets ‚Üí Calculated Field</li>
                    <li><strong>Select the field</strong> from the Name dropdown</li>
                    <li><strong>To Edit:</strong> Change the formula ‚Üí Modify ‚Üí OK</li>
                    <li><strong>To Delete:</strong> Click Delete ‚Üí OK</li>
                </ol>
            </div>
            </div>
        </div>

        <!-- TUTORIAL 2: SLICERS -->
        <div id="tutorial2" class="tutorial-section">
            <h2 onclick="toggleTutorial('tutorial2')">üéõÔ∏è Tutorial 2: Interactive Slicers</h2>
            <div class="tutorial-content">
            <p>Slicers are visual filter buttons that make pivot tables interactive and user-friendly. Instead of dropdown filters, you get clickable buttons!</p>

            <h3>What are Slicers?</h3>
            <p>Slicers are visual filters that let you click to filter your pivot table. Benefits:</p>
            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                <li>Easy to see what's currently filtered</li>
                <li>Click to select/deselect multiple items</li>
                <li>Professional dashboard appearance</li>
                <li>Can control multiple pivot tables at once</li>
                <li>Great for presentations and reports</li>
            </ul>

            <h3>Step-by-Step: Adding a Slicer</h3>
            <div class="step-list">
                <ol>
                    <li><strong>Click in your pivot table</strong></li>
                    <li><strong>PivotTable Analyze tab</strong> ‚Üí Insert Slicer button</li>
                    <li><strong>Check the fields</strong> you want slicers for:
                        <ul style="margin-top: 0.5rem;">
                            <li>‚úì Department (to filter by Fabrication, Assembly, Finishing)</li>
                            <li>‚úì Status (to filter Completed vs In Progress)</li>
                            <li>‚úì Month (to filter by time period)</li>
                        </ul>
                    </li>
                    <li><strong>Click OK</strong></li>
                    <li>Slicers appear as floating panels!</li>
                </ol>
            </div>

            <div class="visual-example">
                <p><strong>Your slicers will show:</strong></p>
                <p>üìä <strong>Department Slicer:</strong> Buttons for Fabrication, Assembly, Finishing</p>
                <p>‚úÖ <strong>Status Slicer:</strong> Buttons for Completed, In Progress</p>
                <p>üìÖ <strong>Month Slicer:</strong> Buttons for each month (Jan, Feb, Mar...)</p>
                <p><strong>Click a button</strong> ‚Üí Pivot table filters instantly!</p>
            </div>

            <h3>Task 2: Adding Department and Status Slicers</h3>
            <div class="step-list">
                <ol>
                    <li><strong>Click your pivot table</strong></li>
                    <li><strong>Insert Slicer</strong></li>
                    <li><strong>Check: Department, Status</strong></li>
                    <li><strong>Click OK</strong></li>
                    <li><strong>Position slicers</strong> above or beside your pivot table</li>
                    <li><strong>Resize slicers</strong> by dragging corners</li>
                    <li><strong>Test them:</strong> Click "Fabrication" ‚Üí only Fabrication data shows!</li>
                </ol>
            </div>

            <h3>Using Slicers</h3>
            <table class="example-table">
                <thead>
                    <tr>
                        <th>Action</th>
                        <th>How To</th>
                        <th>Result</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Select ONE item</td>
                        <td>Click the button</td>
                        <td>Shows only that item</td>
                    </tr>
                    <tr>
                        <td>Select MULTIPLE items</td>
                        <td>Ctrl+Click each button</td>
                        <td>Shows all selected items</td>
                    </tr>
                    <tr>
                        <td>Clear filter</td>
                        <td>Click the ‚úñ in top right corner</td>
                        <td>Shows all items again</td>
                    </tr>
                    <tr>
                        <td>Multi-select button</td>
                        <td>Click the icon with checkboxes</td>
                        <td>Enables checkboxes for easy selection</td>
                    </tr>
                </tbody>
            </table>

            <h3>Formatting Slicers</h3>
            <div class="step-list">
                <ol>
                    <li><strong>Click the slicer</strong> to select it</li>
                    <li><strong>Slicer tab</strong> appears in ribbon</li>
                    <li><strong>Browse Slicer Styles</strong> gallery</li>
                    <li><strong>Choose a style:</strong> Blue theme recommended for Apex branding</li>
                    <li><strong>Adjust size:</strong>
                        <ul style="margin-top: 0.5rem;">
                            <li>Slicer tab ‚Üí Buttons ‚Üí Columns (set to 1, 2, or 3)</li>
                            <li>Slicer tab ‚Üí Size ‚Üí Set height and width</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <div class="tip-box">
                <strong>üí° CONNECTING TO MULTIPLE PIVOT TABLES:</strong> Right-click slicer ‚Üí Report Connections ‚Üí check which pivot tables to control. One slicer can filter multiple pivot tables on the same sheet!
            </div>

            <h3>Slicer Settings</h3>
            <p>Right-click a slicer ‚Üí Slicer Settings to:</p>
            <ul style="margin-left: 2rem;">
                <li>Change the caption (header text)</li>
                <li>Sort items (A to Z, or custom order)</li>
                <li>Hide items with no data</li>
            </ul>

            <div class="warning-box">
                <strong>‚ö†Ô∏è PRINT TIP:</strong> Slicers can be printed with your pivot table! Make sure they're positioned nicely on the page. Use Page Layout view to check before printing.
            </div>
            </div>
        </div>

        <!-- TUTORIAL 3: TIMELINES -->
        <div id="tutorial3" class="tutorial-section">
            <h2 onclick="toggleTutorial('tutorial3')">üìÖ Tutorial 3: Timeline Filters</h2>
            <div class="tutorial-content">
            <p>Timelines are specialized slicers for date fields. They let you filter by months, quarters, or years with an elegant visual interface.</p>

            <h3>What is a Timeline?</h3>
            <p>A timeline is like a slicer but specifically designed for dates. It shows:</p>
            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                <li>Visual representation of time periods</li>
                <li>Easy selection of date ranges</li>
                <li>Switch between Days, Months, Quarters, Years</li>
                <li>Drag to select multiple consecutive periods</li>
            </ul>

            <h3>Step-by-Step: Adding a Timeline</h3>
            <div class="step-list">
                <ol>
                    <li><strong>Click in your pivot table</strong></li>
                    <li><strong>PivotTable Analyze tab</strong> ‚Üí Insert Timeline button</li>
                    <li><strong>Select your date field:</strong>
                        <ul style="margin-top: 0.5rem;">
                            <li>For this project: "Date Completed" or "Month Completed"</li>
                        </ul>
                    </li>
                    <li><strong>Click OK</strong></li>
                    <li>Timeline appears!</li>
                </ol>
            </div>

            <div class="visual-example">
                <p><strong>Timeline Appearance:</strong></p>
                <p>A horizontal bar showing months:</p>
                <p>JAN | FEB | MAR | APR | MAY | JUN ...</p>
                <p>Click or drag to select months ‚Üí filters your pivot table!</p>
            </div>

            <h3>Task 3: Adding a Timeline for Monthly Analysis</h3>
            <div class="step-list">
                <ol>
                    <li><strong>Click your pivot table</strong></li>
                    <li><strong>Insert Timeline</strong></li>
                    <li><strong>Choose "Date Completed"</strong> (or your date field)</li>
                    <li><strong>Click OK</strong></li>
                    <li><strong>Position timeline</strong> near your slicers</li>
                    <li><strong>Change time period:</strong> Click dropdown (top right) ‚Üí select MONTHS</li>
                    <li><strong>Test it:</strong> Click "February" ‚Üí see only February data!</li>
                </ol>
            </div>

            <h3>Using Timelines</h3>
            <table class="example-table">
                <thead>
                    <tr>
                        <th>Action</th>
                        <th>How To</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Select one period</td>
                        <td>Click it</td>
                        <td>Click "March" ‚Üí March data only</td>
                    </tr>
                    <tr>
                        <td>Select range</td>
                        <td>Click and drag</td>
                        <td>Drag from Feb to Apr ‚Üí Q1 data</td>
                    </tr>
                    <tr>
                        <td>Change time level</td>
                        <td>Dropdown ‚Üí MONTHS, QUARTERS, YEARS</td>
                        <td>Switch to QUARTERS for quarterly view</td>
                    </tr>
                    <tr>
                        <td>Clear filter</td>
                        <td>Click ‚úñ button</td>
                        <td>Shows all dates</td>
                    </tr>
                    <tr>
                        <td>Scroll time</td>
                        <td>Use < > arrows</td>
                        <td>Navigate to earlier/later periods</td>
                    </tr>
                </tbody>
            </table>

            <div class="tip-box">
                <strong>üí° YEAR-OVER-YEAR ANALYSIS:</strong> Set timeline to YEARS, then select multiple years to compare trends across years. Great for executive reports!
            </div>

            <h3>Formatting Timelines</h3>
            <div class="step-list">
                <ol>
                    <li><strong>Click the timeline</strong></li>
                    <li><strong>Timeline tab</strong> appears</li>
                    <li><strong>Choose a style</strong> from Timeline Styles gallery</li>
                    <li><strong>Resize:</strong> Timeline tab ‚Üí Size group</li>
                    <li><strong>Caption:</strong> Timeline tab ‚Üí Timeline Caption</li>
                </ol>
            </div>

            <div class="warning-box">
                <strong>‚ö†Ô∏è REQUIREMENT:</strong> Timelines only work with DATE fields, not text. If your "Month Completed" is text ("January", "February"), you'll need to use the actual completion date field instead.
            </div>

            <h3>Timeline + Slicer Combination</h3>
            <p>Powerful analysis when combined:</p>
            <div class="code-example">
<span class="comment">// Example: Find Fabrication costs in Q1</span>
<span class="function">Department Slicer</span>: Click "Fabrication"
<span class="function">Timeline</span>: Drag from Jan to Mar
<span class="comment">‚Üí Pivot table shows ONLY Fabrication costs for Jan-Mar!</span>
            </div>
            </div>
        </div>

        <!-- TUTORIAL 4: EXECUTIVE DASHBOARDS -->
        <div id="tutorial4" class="tutorial-section">
            <h2 onclick="toggleTutorial('tutorial4')">üìä Tutorial 4: Building Executive Dashboards</h2>
            <div class="tutorial-content">
            <p>An executive dashboard combines multiple pivot tables, charts, slicers, and timelines on one sheet for comprehensive at-a-glance analysis.</p>

            <h3>What Makes a Good Dashboard?</h3>
            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                <li><strong>Clear Purpose:</strong> Answers specific business questions</li>
                <li><strong>Visual Hierarchy:</strong> Most important info at top/center</li>
                <li><strong>Interactivity:</strong> Slicers and timelines for exploration</li>
                <li><strong>Mix of Visuals:</strong> Charts AND tables for different insights</li>
                <li><strong>Professional Design:</strong> Consistent colors, clean layout</li>
                <li><strong>One Page:</strong> Everything visible without scrolling (if possible)</li>
            </ul>

            <h3>Task 4: Creating Your Executive Dashboard</h3>
            <p>Build a dashboard showing production performance across departments and time:</p>

            <h4>Layout Plan</h4>
            <div class="visual-example">
                <p><strong>Suggested Dashboard Layout:</strong></p>
                <p>‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê</p>
                <p>‚îÇ TITLE: Production Performance       ‚îÇ</p>
                <p>‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</p>
                <p>‚îÇ [Dept Slicer] [Status] [Timeline]   ‚îÇ</p>
                <p>‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</p>
                <p>‚îÇ Dept Costs   ‚îÇ  Cost Trend Chart    ‚îÇ</p>
                <p>‚îÇ Pivot Table  ‚îÇ  (Line Chart)        ‚îÇ</p>
                <p>‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§</p>
                <p>‚îÇ Units by     ‚îÇ  Dept Comparison     ‚îÇ</p>
                <p>‚îÇ Department   ‚îÇ  (Column Chart)      ‚îÇ</p>
                <p>‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò</p>
            </div>

            <h4>Step-by-Step Dashboard Creation</h4>
            <div class="step-list">
                <ol>
                    <li><strong>Create a new worksheet</strong> named "Executive Dashboard"</li>
                    <li><strong>Add a title:</strong>
                        <ul style="margin-top: 0.5rem;">
                            <li>Cell A1: "APEX MANUFACTURING - PRODUCTION DASHBOARD"</li>
                            <li>Format: Large font (18pt), Bold, Blue</li>
                            <li>Merge cells A1:H1</li>
                        </ul>
                    </li>
                    <li><strong>Copy your pivot tables</strong> from other sheets:
                        <ul style="margin-top: 0.5rem;">
                            <li>Department costs with calculated field</li>
                            <li>Monthly production volume</li>
                        </ul>
                    </li>
                    <li><strong>Create new pivot charts:</strong>
                        <ul style="margin-top: 0.5rem;">
                            <li>Line chart: Monthly cost trends</li>
                            <li>Column chart: Department comparison</li>
                        </ul>
                    </li>
                    <li><strong>Add slicers:</strong> Department, Status</li>
                    <li><strong>Add timeline:</strong> Date Completed</li>
                    <li><strong>Arrange everything:</strong> Drag to position nicely</li>
                    <li><strong>Format consistently:</strong>
                        <ul style="margin-top: 0.5rem;">
                            <li>All charts use Blue color theme</li>
                            <li>All slicers use same style</li>
                            <li>Remove gridlines: View tab ‚Üí uncheck Gridlines</li>
                        </ul>
                    </li>
                </ol>
            </div>

            <h3>Dashboard Best Practices</h3>
            <table class="example-table">
                <thead>
                    <tr>
                        <th>Element</th>
                        <th>Best Practice</th>
                        <th>Why</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Color Scheme</td>
                        <td>Use 2-3 colors max, consistent throughout</td>
                        <td>Professional appearance, easier to read</td>
                    </tr>
                    <tr>
                        <td>White Space</td>
                        <td>Leave gaps between elements</td>
                        <td>Prevents cluttered look</td>
                    </tr>
                    <tr>
                        <td>Chart Titles</td>
                        <td>Clear, descriptive (not just "Chart 1")</td>
                        <td>Instant understanding of what's shown</td>
                    </tr>
                    <tr>
                        <td>Slicer Position</td>
                        <td>Top of dashboard, grouped together</td>
                        <td>Easy to find and use</td>
                    </tr>
                    <tr>
                        <td>Data Labels</td>
                        <td>Add to charts for exact values</td>
                        <td>No guessing from axis</td>
                    </tr>
                    <tr>
                        <td>Print Layout</td>
                        <td>Fit to one page (landscape usually better)</td>
                        <td>Can print for meetings</td>
                    </tr>
                </tbody>
            </table>

            <div class="tip-box">
                <strong>üí° CONNECTING SLICERS TO MULTIPLE PIVOT TABLES:</strong> This is the dashboard magic! Right-click any slicer ‚Üí Report Connections ‚Üí check ALL pivot tables on the dashboard. Now one slicer controls everything!
            </div>

            <h3>Chart Types for Different Insights</h3>
            <table class="example-table">
                <thead>
                    <tr>
                        <th>Use This Chart</th>
                        <th>When You Want To Show</th>
                        <th>Example</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Line Chart</td>
                        <td>Trends over time</td>
                        <td>Monthly production costs</td>
                    </tr>
                    <tr>
                        <td>Column Chart</td>
                        <td>Compare categories</td>
                        <td>Cost by department</td>
                    </tr>
                    <tr>
                        <td>Pie Chart</td>
                        <td>Parts of a whole (% breakdown)</td>
                        <td>Department % of total cost</td>
                    </tr>
                    <tr>
                        <td>Combo Chart</td>
                        <td>Two different metrics together</td>
                        <td>Units (bars) + Cost per Unit (line)</td>
                    </tr>
                    <tr>
                        <td>Waterfall</td>
                        <td>Cumulative effect of changes</td>
                        <td>Cost build-up (DM + DL + OH)</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning-box">
                <strong>‚ö†Ô∏è AVOID DASHBOARD MISTAKES:</strong> Don't overcrowd! If you need to scroll or squint, you have too much. Focus on the 3-5 most important metrics. You can always create additional dashboard pages for detailed analysis.
            </div>

            <h3>Final Dashboard Touches</h3>
            <ul style="margin-left: 2rem;">
                <li>Remove row/column headers: File ‚Üí Options ‚Üí Advanced ‚Üí uncheck "Show row and column headers"</li>
                <li>Add instructions text: "Use slicers above to filter data"</li>
                <li>Set print area: Page Layout ‚Üí Print Area ‚Üí Set Print Area</li>
                <li>Add your name/date in header: Insert ‚Üí Header & Footer</li>
            </ul>
            </div>
        </div>

        <!-- TUTORIAL 5: GROUPING DATA -->
        <div id="tutorial5" class="tutorial-section">
            <h2 onclick="toggleTutorial('tutorial5')">üîÑ Tutorial 5: Grouping Data in Pivot Tables</h2>
            <div class="tutorial-content">
            <p>Grouping lets you combine rows or columns into categories. Perfect for analyzing quarters from months, or creating custom categories.</p>

            <h3>What is Grouping?</h3>
            <p>Grouping combines individual items into meaningful categories:</p>
            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                <li>Group months into quarters (Jan-Mar = Q1)</li>
                <li>Group departments into divisions</li>
                <li>Group costs into ranges ($0-$50k, $50k-$100k, $100k+)</li>
                <li>Group dates into weeks or years</li>
            </ul>

            <h3>Grouping Dates by Month/Quarter/Year</h3>
            <div class="step-list">
                <ol>
                    <li><strong>Right-click any date</strong> in your pivot table Row Labels</li>
                    <li><strong>Choose "Group"</strong></li>
                    <li><strong>Select time periods:</strong>
                        <ul style="margin-top: 0.5rem;">
                            <li>Check "Months" for monthly view</li>
                            <li>Check "Quarters" to add quarterly grouping</li>
                            <li>Check "Years" if you have multiple years</li>
                            <li>You can check MULTIPLE at once!</li>
                        </ul>
                    </li>
                    <li><strong>Click OK</strong></li>
                    <li>Dates are now grouped!</li>
                </ol>
            </div>

            <div class="visual-example">
                <p><strong>Before Grouping:</strong></p>
                <p>2024-01-15<br>2024-01-22<br>2024-02-05<br>2024-02-18</p>
                <p style="margin-top: 1rem;"><strong>After Grouping by Month:</strong></p>
                <p>January (2 jobs)<br>February (2 jobs)</p>
                <p style="margin-top: 1rem;"><strong>After Grouping by Quarter:</strong></p>
                <p>Q1 (4 jobs total)<br> ‚Ü≥ January (2 jobs)<br> ‚Ü≥ February (2 jobs)</p>
            </div>

            <h3>Grouping Numbers into Ranges</h3>
            <div class="step-list">
                <ol>
                    <li><strong>Right-click a number value</strong> in Row Labels</li>
                    <li><strong>Choose "Group"</strong></li>
                    <li><strong>Set the range:</strong>
                        <ul style="margin-top: 0.5rem;">
                            <li>Starting at: 0</li>
                            <li>Ending at: 100000</li>
                            <li>By: 25000 (creates $25k buckets)</li>
                        </ul>
                    </li>
                    <li><strong>Click OK</strong></li>
                    <li>Numbers grouped into ranges!</li>
                </ol>
            </div>

            <div class="visual-example">
                <p><strong>Grouping Total Costs by $25k buckets:</strong></p>
                <p>0-25000: 3 jobs<br>25000-50000: 7 jobs<br>50000-75000: 4 jobs<br>75000-100000: 1 job</p>
            </div>

            <h3>Manual Grouping (Custom Categories)</h3>
            <p>Create your own groupings by selecting items:</p>
            <div class="step-list">
                <ol>
                    <li><strong>In your pivot table, hold Ctrl</strong> and click items to group together</li>
                    <li>Example: Ctrl+Click "Fabrication" and "Assembly"</li>
                    <li><strong>Right-click</strong> ‚Üí Group</li>
                    <li><strong>Excel creates "Group1"</strong> containing those items</li>
                    <li><strong>Click "Group1"</strong> and type a better name like "Production Depts"</li>
                    <li>Repeat for other groupings</li>
                </ol>
            </div>

            <div class="tip-box">
                <strong>üí° DRILL DOWN:</strong> After grouping, you can expand/collapse groups! Click the [+] / [-] buttons next to group names to show/hide details.
            </div>

            <h3>Ungrouping</h3>
            <p>To remove grouping:</p>
            <ul style="margin-left: 2rem;">
                <li>Right-click any grouped item ‚Üí Ungroup</li>
                <li>Or right-click group name ‚Üí Ungroup</li>
                <li>Items return to original ungrouped state</li>
            </ul>

            <h3>Practical Grouping Examples</h3>
            <table class="example-table">
                <thead>
                    <tr>
                        <th>Original Data</th>
                        <th>Grouping Strategy</th>
                        <th>Result</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Individual dates</td>
                        <td>Group by Months, Quarters</td>
                        <td>Quarterly financial reports</td>
                    </tr>
                    <tr>
                        <td>Job costs: $12k, $45k, $78k...</td>
                        <td>Group by $25k increments</td>
                        <td>Distribution of job sizes</td>
                    </tr>
                    <tr>
                        <td>50 products</td>
                        <td>Manually group into product lines</td>
                        <td>Sales by product category</td>
                    </tr>
                    <tr>
                        <td>Fabrication, Assembly, Finishing</td>
                        <td>Group Fab+Assembly as "Production"</td>
                        <td>Production vs Finishing costs</td>
                    </tr>
                </tbody>
            </table>

            <div class="warning-box">
                <strong>‚ö†Ô∏è DATE GROUPING QUIRK:</strong> When you group dates, Excel sometimes auto-adds a "Years" field even if you only have one year. You can remove it by dragging "Years" out of the Rows area in the Field List.
            </div>
            </div>
        </div>

        <!-- TUTORIAL 6: POWER PIVOT PREVIEW -->
        <div id="tutorial6" class="tutorial-section">
            <h2 onclick="toggleTutorial('tutorial6')">‚ö° Tutorial 6: Introduction to Power Pivot (Preview)</h2>
            <div class="tutorial-content">
            <p>Power Pivot is an advanced Excel add-in that handles millions of rows, creates relationships between tables, and uses DAX formulas. This is a preview for future phases!</p>

            <h3>What is Power Pivot?</h3>
            <p>Power Pivot extends regular pivot tables with:</p>
            <ul style="margin-left: 2rem; margin-top: 0.5rem;">
                <li><strong>Huge datasets:</strong> Handle millions of rows (vs Excel's 1M limit)</li>
                <li><strong>Multiple tables:</strong> Link related tables together (like a database)</li>
                <li><strong>DAX formulas:</strong> More powerful than calculated fields</li>
                <li><strong>Calendar intelligence:</strong> Built-in date functions (YTD, MTD, same period last year)</li>
                <li><strong>KPIs:</strong> Key performance indicators with targets</li>
            </ul>

            <h3>When to Use Power Pivot vs Regular Pivot Tables</h3>
            <table class="example-table">
                <thead>
                    <tr>
                        <th>Use Regular Pivot Tables When</th>
                        <th>Use Power Pivot When</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Data under 100,000 rows</td>
                        <td>Data over 1 million rows</td>
                    </tr>
                    <tr>
                        <td>Single table analysis</td>
                        <td>Multiple related tables (Orders + Customers + Products)</td>
                    </tr>
                    <tr>
                        <td>Simple calculations (sum, count, average)</td>
                        <td>Complex calculations (% of parent, time intelligence)</td>
                    </tr>
                    <tr>
                        <td>Quick ad-hoc analysis</td>
                        <td>Formal business intelligence reports</td>
                    </tr>
                    <tr>
                        <td>Departmental reporting</td>
                        <td>Enterprise-wide analytics</td>
                    </tr>
                </tbody>
            </table>

            <h3>Enabling Power Pivot</h3>
            <div class="step-list">
                <ol>
                    <li><strong>File</strong> ‚Üí Options</li>
                    <li><strong>Add-ins</strong> (left sidebar)</li>
                    <li><strong>Manage:</strong> COM Add-ins ‚Üí Go</li>
                    <li><strong>Check "Microsoft Power Pivot for Excel"</strong></li>
                    <li><strong>Click OK</strong></li>
                    <li>New "Power Pivot" tab appears in ribbon!</li>
                </ol>
            </div>

            <div class="visual-example">
                <p><strong>Example: Multi-Table Analysis</strong></p>
                <p><strong>Table 1 - Jobs:</strong> Job Number, Customer ID, Total Cost</p>
                <p><strong>Table 2 - Customers:</strong> Customer ID, Customer Name, Industry</p>
                <p><strong>Power Pivot:</strong> Create relationship on Customer ID</p>
                <p><strong>Result:</strong> Analyze costs by Industry (without manual VLOOKUP!)</p>
            </div>

            <h3>Power Pivot Data Model</h3>
            <p>The data model is like having a mini-database in Excel:</p>
            <div class="step-list">
                <ol>
                    <li><strong>Power Pivot tab</strong> ‚Üí Add to Data Model</li>
                    <li><strong>Manage button</strong> ‚Üí Opens Power Pivot window</li>
                    <li><strong>Add multiple tables</strong> to the model</li>
                    <li><strong>Diagram View:</strong> See all tables and relationships visually</li>
                    <li><strong>Create relationships:</strong> Drag from one table's key field to another</li>
                </ol>
            </div>

            <h3>Introduction to DAX (Data Analysis Expressions)</h3>
            <p>DAX is Power Pivot's formula language. Similar to Excel formulas but more powerful:</p>

            <div class="code-example">
<span class="comment">// Simple DAX examples</span>
<span class="function">Total Sales</span> = SUM([Amount])
<span class="function">Year to Date</span> = TOTALYTD([Total Sales], Calendar[Date])
<span class="function">Same Period Last Year</span> = CALCULATE([Total Sales], SAMEPERIODLASTYEAR(Calendar[Date]))
<span class="function">Profit Margin %</span> = DIVIDE([Total Profit], [Total Sales], 0)
            </div>

            <div class="tip-box">
                <strong>üí° FUTURE PHASES:</strong> You'll learn Power Pivot in Phase 6-7 when analyzing larger datasets with multiple related tables. For now, master regular pivot tables - they're the foundation!
            </div>

            <h3>Power Pivot vs Power Query</h3>
            <p>Don't confuse these two "Power" tools:</p>
            <table class="example-table">
                <thead>
                    <tr>
                        <th>Tool</th>
                        <th>Purpose</th>
                        <th>Example Use</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Power Query</strong></td>
                        <td>ETL: Extract, Transform, Load data</td>
                        <td>Clean messy data, combine files, remove duplicates</td>
                    </tr>
                    <tr>
                        <td><strong>Power Pivot</strong></td>
                        <td>Data modeling and advanced analysis</td>
                        <td>Relate tables, create complex calculations, huge datasets</td>
                    </tr>
                </tbody>
            </table>

            <p style="margin-top: 1.5rem;">Often used together: Power Query cleans the data ‚Üí Power Pivot analyzes it!</p>

            <div class="warning-box">
                <strong>‚ö†Ô∏è NOT REQUIRED FOR PHASE 3:</strong> This tutorial is preview only. Phase 3 focuses on regular pivot tables with slicers, timelines, and calculated fields. Power Pivot comes later!
            </div>

            <h3>Learning Resources</h3>
            <p>To learn more about Power Pivot (for future phases):</p>
            <ul style="margin-left: 2rem;">
                <li>Microsoft's Power Pivot documentation</li>
                <li>SQLBI.com for DAX tutorials</li>
                <li>Excel Power Pivot & Power Query courses on LinkedIn Learning</li>
                <li>Practice with sample datasets before using on real data</li>
            </ul>
            </div>
        </div>

        <div class="instructions">
            <h4>üéØ Ready to Complete Phase 3!</h4>
            <p style="margin-top: 0.5rem;">You've learned advanced pivot table techniques! Now apply them:</p>
            <ul style="margin-top: 0.5rem;">
                <li>Complete process costing calculations</li>
                <li>Create pivot table with calculated field (cost per unit)</li>
                <li>Add slicers for interactivity</li>
                <li>Add timeline for monthly filtering</li>
                <li>Build executive dashboard with multiple charts</li>
                <li>Analyze production efficiency and identify bottlenecks</li>
                <li>Write management report with dashboard screenshots</li>
            </ul>
        </div>

        <div class="check-figures-section">
            <h3>‚úì Interactive Check Figures - Process Costing</h3>
            <p>Enter your calculated values below to verify your process costing work. The system will provide immediate feedback!</p>

            <div class="check-grid">
                <div class="check-item">
                    <label for="euMaterials">
                        Equivalent Units - Materials (Dept 1)
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltiptext">Units completed + (Ending WIP √ó % complete)</span>
                        </span>
                    </label>
                    <input type="text" id="euMaterials" placeholder="Enter units (e.g., 24,000)" oninput="checkValue(this, 23500)">
                    <div class="feedback"></div>
                </div>

                <div class="check-item">
                    <label for="euConversion">
                        Equivalent Units - Conversion (Dept 1)
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltiptext">Units completed + (Ending WIP √ó % complete for conversion)</span>
                        </span>
                    </label>
                    <input type="text" id="euConversion" placeholder="Enter units (e.g., 22,500)" oninput="checkValue(this, 22800)">
                    <div class="feedback"></div>
                </div>

                <div class="check-item">
                    <label for="costPerEUMaterials">
                        Cost per EU - Materials
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltiptext">Total Materials Cost / EU Materials</span>
                        </span>
                    </label>
                    <input type="text" id="costPerEUMaterials" placeholder="Enter cost (e.g., 12.50)" oninput="checkValue(this, 11.80, 0.01)">
                    <div class="feedback"></div>
                </div>

                <div class="check-item">
                    <label for="costPerEUConversion">
                        Cost per EU - Conversion
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltiptext">Total Conversion Cost / EU Conversion</span>
                        </span>
                    </label>
                    <input type="text" id="costPerEUConversion" placeholder="Enter cost (e.g., 8.75)" oninput="checkValue(this, 8.95, 0.01)">
                    <div class="feedback"></div>
                </div>

                <div class="check-item">
                    <label for="costTransferredOut">
                        Cost of Units Transferred Out
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltiptext">Units transferred √ó (Cost per EU Materials + Conversion)</span>
                        </span>
                    </label>
                    <input type="text" id="costTransferredOut" placeholder="Enter amount (e.g., 425,000)" oninput="checkValue(this, 441750)">
                    <div class="feedback"></div>
                </div>

                <div class="check-item">
                    <label for="endingWIPCost">
                        Ending WIP Inventory Cost
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltiptext">Materials + Conversion costs in ending WIP</span>
                        </span>
                    </label>
                    <input type="text" id="endingWIPCost" placeholder="Enter amount (e.g., 32,000)" oninput="checkValue(this, 35450)">
                    <div class="feedback"></div>
                </div>

                <div class="check-item">
                    <label for="totalCostAccounted">
                        Total Cost Accounted For
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltiptext">Transferred Out + Ending WIP (should equal costs to account for)</span>
                        </span>
                    </label>
                    <input type="text" id="totalCostAccounted" placeholder="Enter amount (e.g., 480,000)" oninput="checkValue(this, 477200)">
                    <div class="feedback"></div>
                </div>

                <div class="check-item">
                    <label for="avgCostPerUnit">
                        Average Cost per Unit Completed
                        <span class="tooltip">‚ÑπÔ∏è
                            <span class="tooltiptext">Cost Transferred Out / Units Transferred</span>
                        </span>
                    </label>
                    <input type="text" id="avgCostPerUnit" placeholder="Enter cost (e.g., 22.50)" oninput="checkValue(this, 20.75, 0.05)">
                    <div class="feedback"></div>
                </div>
            </div>

            <button class="verify-all-btn" onclick="verifyAll()">üéØ Verify All Answers</button>
            
            <div class="overall-score" id="overallScore"></div>
        </div>
    </div>

    <script>
        // Store correct answers
        const correctAnswers = {
            euMaterials: 23500,
            euConversion: 22800,
            costPerEUMaterials: 11.80,
            costPerEUConversion: 8.95,
            costTransferredOut: 441750,
            endingWIPCost: 35450,
            totalCostAccounted: 477200,
            avgCostPerUnit: 20.75
        };

        // Store tolerance for each answer
        const tolerances = {
            euMaterials: 0,
            euConversion: 0,
            costPerEUMaterials: 0.01,
            costPerEUConversion: 0.01,
            costTransferredOut: 0,
            endingWIPCost: 0,
            totalCostAccounted: 0,
            avgCostPerUnit: 0.05
        };

        function checkValue(input, correctValue, tolerance = 0) {
            const feedbackDiv = input.nextElementSibling;
            const userValue = parseFloat(input.value.replace(/[$,]/g, ''));
            
            if (isNaN(userValue)) {
                feedbackDiv.className = 'feedback';
                feedbackDiv.style.display = 'none';
                return false;
            }

            const difference = Math.abs(userValue - correctValue);
            
            if (difference <= tolerance) {
                feedbackDiv.className = 'feedback correct';
                feedbackDiv.innerHTML = '‚úì Correct!';
                input.style.borderColor = 'var(--success-green)';
                return true;
            } else {
                feedbackDiv.className = 'feedback incorrect';
                const percentOff = ((difference / correctValue) * 100).toFixed(1);
                feedbackDiv.innerHTML = `‚úó Not quite. You're ${percentOff}% off. Double-check your calculations.`;
                input.style.borderColor = 'var(--error-red)';
                return false;
            }
        }

        function verifyAll() {
            let correct = 0;
            let total = 0;
            
            for (const [id, correctValue] of Object.entries(correctAnswers)) {
                const input = document.getElementById(id);
                const tolerance = tolerances[id] || 0;
                total++;
                
                if (checkValue(input, correctValue, tolerance)) {
                    correct++;
                }
            }
            
            const scoreDiv = document.getElementById('overallScore');
            const percentage = ((correct / total) * 100).toFixed(0);
            
            let message = '';
            let emoji = '';
            
            if (percentage === '100') {
                emoji = 'üéâ';
                message = `Perfect! ${correct}/${total} correct!`;
            } else if (percentage >= '75') {
                emoji = 'üëç';
                message = `Good work! ${correct}/${total} correct. Review the incorrect answers.`;
            } else if (percentage >= '50') {
                emoji = 'üìö';
                message = `Keep trying! ${correct}/${total} correct. Review your calculations.`;
            } else {
                emoji = 'üí™';
                message = `${correct}/${total} correct. Don't give up! Review the formulas and try again.`;
            }
            
            scoreDiv.innerHTML = `${emoji} ${message}`;
            scoreDiv.className = 'overall-score show';
            
            // Scroll to score
            scoreDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        // Format inputs as currency on blur
        document.querySelectorAll('input[type="text"]').forEach(input => {
            input.addEventListener('blur', function() {
                const value = parseFloat(this.value.replace(/[$,]/g, ''));
                if (!isNaN(value) && !this.id.includes('costPer') && !this.id.includes('avg') && !this.id.includes('eu')) {
                    this.value = value.toLocaleString('en-US');
                }
            });
            
            input.addEventListener('focus', function() {
                this.value = this.value.replace(/,/g, '');
            });
        });

        // Collapsible tutorial functions
        function toggleTutorial(tutorialId) {
            const tutorial = document.getElementById(tutorialId);
            if (tutorial) {
                tutorial.classList.toggle('collapsed');
            }
        }

        function expandTutorial(tutorialId) {
            const tutorial = document.getElementById(tutorialId);
            if (tutorial) {
                // Expand the section if it's collapsed
                tutorial.classList.remove('collapsed');
                
                // Smooth scroll to the tutorial with offset for header
                setTimeout(() => {
                    tutorial.scrollIntoView({ behavior: 'smooth', block: 'start' });
                }, 100);
            }
        }

        // Initialize - expand all tutorials by default
        document.addEventListener('DOMContentLoaded', function() {
            // All tutorials start expanded (no collapsed class)
        });
    </script>
</body>
</html>
